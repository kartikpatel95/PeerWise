<!DOCTYPE html>
<html>

<head>
    <title>Create Question</title>


    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="scripts/progressBar.js"></script>
    <script src="https://cloud.tinymce.com/stable/tinymce.min.js"></script>
    <script>
    tinymce.init({
            selector:'textarea',
            menubar: false,
            statusbar: false,
            toolbar: "styleselect fontselect fontsizeselect | forecolor backcolor",
            plugins: "textcolor",
            setup : function(ed) {
                   ed.on('keydown', function(e) {
                      checkIfText();
                   });
                   /*
                   ed.on('focus', function () {
                     $(this.contentAreaContainer.parentElement).find("div.mce-toolbar-grp").show();

                  });
                    ed.on('blur', function () {
                      $(this.contentAreaContainer.parentElement).find("div.mce-toolbar-grp").hide();

                  });
                    ed.on("init", function () {
                    $(this.contentAreaContainer.parentElement).find("div.mce-toolbar-grp").hide();

                });*/
          }
   });

   </script>

   <div class= "jumbotron">
       <img id="logo" src="images/logo.png" style="margin: -50px;">
          <div id="profile-container" class="well" align="right" style="Margin-top: -40px; width: 400px; height: 175px; margin-right: 2%; margin-bottom:0px; padding-left: 0px; float: right;">
            <img id="levelImg2" class="" src="" align="left" height="125px;" style="margin-left:10%; margin-top: 1%;">
            <img id="profile-pic" src="images/user.png" onclick="openModal()" alt="User" height="100px" width="100px" align="right" style="margin-top: -5px; cursor: pointer;">

           <br><br><br><br><br>
           <p style="color:black; text-align: right; margin-bottom: 16px;"> <strong>Group8b</strong></p>
           <progress id="progressbar" class="progress-bar" max="100" value="0"></progress>
         </div>
   </div>


      <nav>
        <ul>
          <li class="divider-right"><a href="index.html">Logout</a></li>
          <li class="divider-right"><a href="course.html">Home</a></li>
          <li class="divider-right"><a href="menu.html">CS101</a></li>
          <li class="active"><a href="#">Create Question</a></li>
        </ul>
      </nav>
</head>

<body>



<div class="container">
<br><br>
  <h2 class="pageHeaders">Write Questions</h2>
   <p class ="pageInfo">Create your authord question related to the topics we have colvered below.</p>
  <hr>


    <div class="form-group">
      <label for="question">Question:</label>
	  <p>Write the <strong>main text</strong> of the question below. Make sure the question is clear and unambiguous, and use language which is professional.
	  Feel free to format the text of your question using the formatting options.</p>
      <textarea id="ques" type="question" class="form-control" onkeypress="checkIfText()"></textarea><br>
      	<p><strong>Alternatives:</strong></p>
        <p>Write up to <strong>four</strong>alternative answers for the question you have written above. You must ensure that exactly one of the alternatives is the correct answer to your question.
		<br><br>You <strong>must indicate </strong>which of the alternatives is the correct answer to your question by selecting the letter to the left of the alternative.</p>
        <div class="row">
          <div id="letter1" class="container well col-md-1 questionOptions" onclick ='selectAnswer("0")'>
            <p><strong>A<br>Select</strong></p>
          </div>
          <div class="container col-md-10" ;>
            <textarea class="col-sm-8" id="ans1" type="text" name="LastName" onkeypress="checkIfText()"></textarea>
          </div>
        </div>
        <div class="row">
          <div id="letter2" class="container well col-md-1 questionOptions" onclick ='selectAnswer("1")'>
            <p><strong>B<br>Select</strong></p>
          </div>
          <div class="container col-md-10" ;>
            <textarea class="col-sm-8" id="ans2" type="text" name="LastName" onkeypress="checkIfText()"></textarea>
          </div>
        </div>
        <div class="row">
          <div id="letter3" class="container well col-md-1 questionOptions" onclick ='selectAnswer("2")'>
            <p><strong>C<br>Select</strong></p>
          </div>
          <div class="container col-md-10" ;>
            <textarea class="col-sm-8" id="ans3" type="text" name="LastName" onkeypress="checkIfText()"></textarea>
          </div>
        </div>
        <div class="row">
          <div id="letter4" class="container well col-md-1 questionOptions" onclick ='selectAnswer("3")'>
            <p><strong>D<br>Select</strong></p>
          </div>
          <div class="container col-md-10" ;>
            <textarea class="col-sm-8" id="ans4" type="text" name="LastName" onkeypress="checkIfText()"></textarea>
          </div>
        </div>
    </div>
    <button id="submitBtn" type="submit" onclick ="validateForm()" class="btn btn-default">Submit</button>
</div>


<!-- The Modal -->
<div id="profileModal" class="modal">
<!-- Modal content -->
  <div class="modal-content" id="profile">
    <div class="modal-header">
      <span class="closeProfile">&times;</span>
      <h2>Profile</h2>
      <img src="images/user.png" alt="User" height="100px" width="100px" align="right" class="user">
    </div>
  <div class="well">
      <div id="profile_experience">
          <h3>Experience</h3>
          <progress id="progressbar_profile" class="progress-bar makeHidden" max="100" value="1" align="right"></progress>
          <img id="levelImg" class="makeHidden" src="images/awards/star1.png" alt="star" align="left" height="50px;" width="50px">
      </div>

      <div id="tab_container">
          <button class="profile_tab" id="badge_button" onclick=showBadge()>Badge</button>
          <button class="profile_tab" id="leaderboard_button" onclick=showLeaderboard()>Leaderboard</button>
      </div>
      <div class="container">
          <div id="badge_container">
              <div class="badge_item">
                  <img id="achievement_1" class="achievement-image" src="images/badges/leveledup2.jpg" align="left" data-toggle="tooltip" data-placement="bottom">
                  <img id="lock_1" src="images/awards/lock.png" alt="lock" class="lock">
              </div>
              <div class="badge_item">
                  <img id="achievement_2" class="achievement-image" src="images/badges/firstq.jpg" align="left" data-toggle="tooltip" data-placement="bottom">
                  <img id="lock_2" src="images/awards/lock.png" alt="lock" class="lock">
              </div>
              <div class="badge_item">
                  <img id="achievement_3" class="achievement-image" src="images/badges/firstans.jpg" align="left" data-toggle="tooltip" data-placement="bottom">
                  <img id="lock_3" src="images/awards/lock.png" alt="lock" class="lock">
              </div>
              <div class="badge_item">
                  <img id="achievement_4" class="achievement-image" src="images/badges/write5q.jpg" align="left" data-toggle="tooltip" data-placement="bottom">
                  <img id="lock_4" src="images/awards/lock.png" alt="lock" class="lock">
              </div>
              <div class="badge_item">
                  <img id="achievement_5" class="achievement-image" src="images/badges/stayon30.jpg" align="left" data-toggle="tooltip" data-placement="bottom">
                  <img id="lock_5" src="images/awards/lock.png" alt="lock" class="lock">
              </div>
              <div class="badge_item">
                  <img id="achievement_6" class="achievement-image" src="images/badges/marathon.jpg" align="left" data-toggle="tooltip" data-placement="bottom">
                  <img id="lock_6" src="images/awards/lock.png" alt="lock" class="lock">
              </div>
              <div class="badge_item">
                  <img id="achievement_7" class="achievement-image" src="images/badges/einstein.jpg" align="left" data-toggle="tooltip" data-placement="bottom">
                  <img id="lock_7" src="images/awards/lock.png" alt="lock" class="lock">
              </div>
              <div class="badge_item">
                  <img id="achievement_8" class="achievement-image" src="images/badges/answerall.jpg" align="left" data-toggle="tooltip" data-placement="bottom">
                  <img id="lock_8" src="images/awards/lock.png" alt="lock" class="lock">
              </div>
              <div class="badge_item">
                  <img id="achievement_9" class="achievement-image" src="images/badges/slack.jpg" align="left" data-toggle="tooltip" data-placement="bottom">
                  <img id="lock_9" src="images/awards/lock.png" alt="lock" class="lock">
              </div>
              <div class="badge_item">
                  <img id="achievement_10" class="achievement-image" src="images/badges/explorer.jpg" align="left" data-toggle="tooltip" data-placement="bottom">
                  <img id="lock_10" src="images/awards/lock.png" alt="lock" class="lock">
              </div>
              <div class="badge_item">
                  <img id="achievement_11" class="achievement-image" src="images/badges/revealed.jpg" align="left" data-toggle="tooltip" data-placement="bottom">
                  <img id="lock_11" src="images/awards/lock.png" alt="lock" class="lock">
              </div>
              <div class="badge_item">
                  <img id="achievement_12" class="achievement-image" src="images/badges/revealed.jpg" align="left" data-toggle="tooltip" data-placement="bottom">
                  <img id="lock_12" src="images/awards/lock.png" alt="lock" class="lock">
              </div>
          </div>

          <div id="leaderboard_container">
              <table class="table table-striped">
                  <thead>
                  <tr>
                      <th>Rank</th>
                      <th>Name</th>
                      <th>Score</th>
                  </tr>
                  </thead>
                  <tbody id="leaderboard_content">

                  </tbody>
              </table>
          </div>
      </div>
  </div>
  </div>
</div>





    <!----------- Footer ------------>


    <footer class="footer-bs">
        <p>PeerWise © University of Auckland</p>
    </footer>


</body>


<script>
var isSelected = null;

var submitBtn = document.getElementById("submitBtn");
submitBtn.disabled = true;

function checkIfText(){
  var question = tinyMCE.get('ques').getContent();
  var ans1 = tinyMCE.get('ans1').getContent();
  var ans2 = tinyMCE.get('ans2').getContent();
  var ans3 = tinyMCE.get('ans3').getContent();
  var ans4 = tinyMCE.get('ans4').getContent();

  if(question != "" && ans1 != "" && ans2 != "" && ans3 != "" && ans4 != "" && isSelected != null){
    submitBtn.disabled = false;
  }else{
    submitBtn.disabled = true;
  }
}

function validateForm() {
    var x = document.getElementById("ques").value;

    if (x == " ") {
        alert("You have missed the question, please fill in the fields");
    }
    else{
      alert("Question Submited");
      addWritten();
      move();
      saveQuestion();
    }
}

function selectAnswer(answerID){
  var buttonID = getButtonID(parseInt(isSelected));
  if(isSelected != null){
    buttonID = getButtonID(parseInt(isSelected));
    var rmSelected = document.getElementById(buttonID);
    rmSelected.style.backgroundColor = "lightgrey";
    rmSelected.style.cursor = "pointer";
  }

  isSelected = answerID;
  buttonID = getButtonID(parseInt(isSelected));
  var makeSelected = document.getElementById(buttonID);
  makeSelected.style.backgroundColor = '#43d9e7';
  makeSelected.style.cursor = "auto";

  checkIfText();
}

function getButtonID(index){
  var buttonID;
  switch (index) {
    case 0:
        buttonID = 'letter1';
        break;
    case 1:
        buttonID = 'letter2';
        break;
    case 2:
        buttonID = 'letter3';
        break;
    case 3:
        buttonID = 'letter4';
        break;
  }
  return buttonID;
}

function saveQuestion(){
  var question = tinyMCE.get('ques').getContent();
  var ans1 = tinyMCE.get('ans1').getContent();
  var ans2 = tinyMCE.get('ans2').getContent();
  var ans3 = tinyMCE.get('ans3').getContent();
  var ans4 = tinyMCE.get('ans4').getContent();

  var numberOfQuestion;

  if(sessionStorage.getItem("totalSubmittedQuestions") == null){
      sessionStorage.setItem("totalSubmittedQuestions", "1");
      var numberOfQuestion = 1;
  }else{
    var numberOfQuestion = parseInt(sessionStorage.getItem("totalSubmittedQuestions")) + 1;
    sessionStorage.setItem("totalSubmittedQuestions", numberOfQuestion.toString());
  }

  var question_key = "ques_" + numberOfQuestion;
  var ans1_key = "ans1_" + numberOfQuestion;
  var ans2_key = "ans2_" + numberOfQuestion;
  var ans3_key = "ans3_" + numberOfQuestion;
  var ans4_key = "ans4_" + numberOfQuestion;
  var ansID_key = "ansID_" + numberOfQuestion;

  sessionStorage.setItem(question_key, question);
  sessionStorage.setItem(ans1_key, ans1);
  sessionStorage.setItem(ans2_key, ans2);
  sessionStorage.setItem(ans3_key, ans3);
  sessionStorage.setItem(ans4_key, ans4);
  sessionStorage.setItem(ansID_key, isSelected);
}

function resetContent(){
  tinyMCE.get('ques').setContent('');
  tinyMCE.get('ans1').setContent('');
  tinyMCE.get('ans2').setContent('');
  tinyMCE.get('ans3').setContent('');
  tinyMCE.get('ans4').setContent('');

  var buttonID = getButtonID(parseInt(isSelected));
  if(isSelected != null){
    buttonID = getButtonID(parseInt(isSelected));
    var rmSelected = document.getElementById(buttonID);
    rmSelected.style.backgroundColor = "lightgrey";
    rmSelected.style.cursor = "pointer";
  }

  submitBtn.disabled = true;
}


</script>
<script src="scripts/profileModal.js"></script>
<script src="scripts/achievementsTooltips.js"></script>
<script src="scripts/profile_tab.js"></script>
</html>
